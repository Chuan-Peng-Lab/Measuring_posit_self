# 使用patchwork拼接两个图
final_plot <- (acc_plot1 / acc_plot2)
return(final_plot)
}
ALT2_acc_plot2(ALT2_plot_phase_003)
# 检查是否已安装 pacman
if (!requireNamespace("pacman", quietly = TRUE)) {
install.packages("pacman") }   # 如果未安装，则安装包
#install.packages("cowplot")
# 加载所需要的R包
pacman::p_load("tidyverse","bruceR","ggplot2","ggridges","psych","psychTools","DataExplorer","patchwork","cowplot")
source("R_rainclouds.R")
ALT2_acc_plot <- function(data) {
# 创建acc的雨云图
acc_plot1 <- ggplot(data %>% filter(domain %in% c("moral")),aes(x=identity,y=acc, fill =identity, colour =identity))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = identity, y =acc),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('Acc')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 3a: ACC of ALT2_moral")
# 创建avg_rt的雨云图
acc_plot2 <- ggplot(data %>% filter(domain %in% c("ability")),aes(x=identity,y=acc, fill =identity, colour =identity))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = identity, y =acc),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('Acc')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 3b: ACC of ALT2_ability")
# 使用patchwork拼接两个图
final_plot <- (acc_plot1 / acc_plot2)
return(final_plot)
}
ALT2_acc_plot(ALT2_plot_phase_003)
ALT2_acc_plot2 <- function(data) {
# 创建acc的雨云图
acc_plot1 <- ggplot(data %>% filter(domain %in% c("moral")),aes(x=valence,y=acc, fill =valence, colour =valence))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = valence, y =acc),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('Acc')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 3a: ACC of ALT2_moral")
# 创建avg_rt的雨云图
acc_plot2 <- ggplot(data %>% filter(domain %in% c("ability")),aes(x=valence,y=acc, fill =valence, colour =valence))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = valence, y =acc),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('Acc')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 3b: ACC of ALT2_ability")
# 使用patchwork拼接两个图
final_plot <- (acc_plot1 / acc_plot2)
return(final_plot)
}
ALT2_acc_plot2(ALT2_plot_phase_003)
ALT2_acc_plot2 <- function(data) {
# 创建acc的雨云图
acc_plot1 <- ggplot(data %>% filter(domain %in% c("moral")),aes(x=valence,y=acc, fill =valence, colour =valence))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = valence, y =acc),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('Acc')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 4a: ACC of ALT2_moral")
# 创建avg_rt的雨云图
acc_plot2 <- ggplot(data %>% filter(domain %in% c("ability")),aes(x=valence,y=acc, fill =valence, colour =valence))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = valence, y =acc),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('Acc')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 4b: ACC of ALT2_ability")
# 使用patchwork拼接两个图
final_plot <- (acc_plot1 / acc_plot2)
return(final_plot)
}
ALT2_acc_plot2(ALT2_plot_phase_003)
ALT2_rt_plot <- function(data) {
# 创建acc的雨云图
rt_plot1 <- ggplot(data %>% filter(domain %in% c("moral")),aes(x=identity,y=avg_rt, fill =identity, colour =identity))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = identity, y =avg_rt),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('rt')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 5a: ACC of ALT2_moral")
# 创建avg_rt的雨云图
rt_plot2 <- ggplot(data %>% filter(domain %in% c("ability")),aes(x=identity,y=avg_rt, fill =identity, colour =identity))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = identity, y =avg_rt),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('rt')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 5b: ACC of ALT2_ability")
# 使用patchwork拼接两个图
final_plot <- (rt_plot1 / rt_plot2)
return(final_plot)
}
ALT2_rt_plot(ALT2_plot_phase_003)
ALT2_rt_plot2 <- function(data) {
# 创建acc的雨云图
rt_plot1 <- ggplot(data %>% filter(domain %in% c("moral")),aes(x=valence,y=avg_rt, fill =valence, colour =valence))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x =valence, y =avg_rt),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('rt')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 6a: RT of ALT2_moral")
# 创建avg_rt的雨云图
rt_plot2 <- ggplot(data %>% filter(domain %in% c("ability")),aes(x=valence,y=avg_rt, fill =valence, colour =valence))+
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = valence, y =avg_rt),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
ylab('rt')+xlab('condition')+coord_flip()+theme_cowplot()+guides(fill = FALSE, colour = FALSE) +
facet_wrap(~person)+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
ggtitle("Figure 6b: RT of ALT2_ability")
# 使用patchwork拼接两个图
final_plot <- (rt_plot1 / rt_plot2)
return(final_plot)
}
ALT2_rt_plot2(ALT2_plot_phase_003)
IAT_phase_003_analysis <- IAT_phase_003 %>%
mutate(ID = as.character(ID)) %>%
mutate(ParticipantID = as.character(ParticipantID)) %>%
mutate(rt=as.numeric(rt))%>%
group_by(ID) %>%
mutate(
version_attrib = case_when(
task_id == "ability"~ (version_attrib[response == "0"& !is.na(version_attrib)]),
TRUE ~ version_attrib),
version_target = case_when(
task_id == "ability"~ (version_target[response == "0"& !is.na(version_target)]),
TRUE ~ version_target),
version_attrib2 = case_when(
task_id == "moral"~ (version_attrib2[response == "0"& !is.na(version_attrib2)]),
TRUE ~ version_attrib2),
version_target2 = case_when(
task_id == "moral"~ (version_target2[response == "0"& !is.na(version_target2)]),
TRUE ~ version_target2))%>%
mutate(version = NA)%>%
mutate(
version = case_when(
version_attrib == version_target & task_id == "ability" & screen_id == 3 ~ "A1",
version_attrib == version_target & task_id == "ability" & screen_id == 4 ~ "A2",
version_attrib == version_target & task_id == "ability" & screen_id == 6 ~ "B1",
version_attrib == version_target & task_id == "ability" & screen_id == 7 ~ "B2",
version_attrib != version_target & task_id == "ability" & screen_id == 3 ~ "B1",
version_attrib != version_target & task_id == "ability" & screen_id == 4 ~ "B2",
version_attrib != version_target & task_id == "ability" & screen_id == 6 ~ "A1",
version_attrib != version_target & task_id == "ability" & screen_id == 7 ~ "A2",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 3 ~ "A1",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 4 ~ "A2",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 6 ~ "B1",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 7 ~ "B2",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 3 ~ "B1",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 4 ~ "B2",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 6 ~ "A1",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 7 ~ "A2",
TRUE ~ version  # 如果没有满足条件的情况，保持原值
))
IAT_phase_003_analysis <- subset(IAT_phase_003, ID %in% subj_phase_003)%>%
mutate(ID = as.character(ID)) %>%
mutate(ParticipantID = as.character(ParticipantID)) %>%
mutate(rt=as.numeric(rt))%>%
group_by(ID) %>%
mutate(
version_attrib = case_when(
task_id == "ability"~ (version_attrib[response == "0"& !is.na(version_attrib)]),
TRUE ~ version_attrib),
version_target = case_when(
task_id == "ability"~ (version_target[response == "0"& !is.na(version_target)]),
TRUE ~ version_target),
version_attrib2 = case_when(
task_id == "moral"~ (version_attrib2[response == "0"& !is.na(version_attrib2)]),
TRUE ~ version_attrib2),
version_target2 = case_when(
task_id == "moral"~ (version_target2[response == "0"& !is.na(version_target2)]),
TRUE ~ version_target2))%>%
mutate(version = NA)%>%
mutate(
version = case_when(
version_attrib == version_target & task_id == "ability" & screen_id == 3 ~ "A1",
version_attrib == version_target & task_id == "ability" & screen_id == 4 ~ "A2",
version_attrib == version_target & task_id == "ability" & screen_id == 6 ~ "B1",
version_attrib == version_target & task_id == "ability" & screen_id == 7 ~ "B2",
version_attrib != version_target & task_id == "ability" & screen_id == 3 ~ "B1",
version_attrib != version_target & task_id == "ability" & screen_id == 4 ~ "B2",
version_attrib != version_target & task_id == "ability" & screen_id == 6 ~ "A1",
version_attrib != version_target & task_id == "ability" & screen_id == 7 ~ "A2",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 3 ~ "A1",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 4 ~ "A2",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 6 ~ "B1",
version_attrib2 == version_target2 & task_id == "moral" & screen_id == 7 ~ "B2",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 3 ~ "B1",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 4 ~ "B2",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 6 ~ "A1",
version_attrib2 != version_target2 & task_id == "moral" & screen_id == 7 ~ "A2",
TRUE ~ version  # 如果没有满足条件的情况，保持原值
))
View(IAT_phase_003_analysis)
IAT_phase_003_D <- IAT_phase_003_analysis%>%
filter(screen_id %in% c(3, 4, 6, 7)) %>%
filter(rt<=10000)%>%
group_by(subj_idx,task_id, version) %>%  ##subj_idx,
summarize(
mean_rt = mean(rt),
sd_rt = sd(rt),
row_n = n()) %>%
ungroup()%>%
pivot_wider(names_from = version, values_from = c(mean_rt, sd_rt,row_n)) %>%
mutate(
diff_B1A1 = mean_rt_B1 - mean_rt_A1,
diff_B2A2 = mean_rt_B2 - mean_rt_A2) %>%
group_by(subj_idx,task_id) %>%##subj_idx,
summarize(
SD_B1A1 = sqrt((((row_n_A1-1)*(sd_rt_A1^2)+(row_n_B1-1)*(sd_rt_B1^2))+((row_n_A1+row_n_B1)*((mean_rt_A1-mean_rt_B1)^2)/4))/(row_n_A1+row_n_B1-1)),
SD_B2A2 = sqrt((((row_n_A2-1)*(sd_rt_A2^2)+(row_n_B2-1)*(sd_rt_B2^2))+((row_n_A2+row_n_B2)*((mean_rt_A2-mean_rt_B2)^2)/4))/(row_n_A2+row_n_B2-1)),
D=( (diff_B1A1/SD_B1A1)+ (diff_B2A2/SD_B2A2))/2
)%>%
mutate(
effect = case_when(
abs(D) <= 0.2 ~ "small",
abs(D) <= 0.5 ~ "mid",
TRUE ~ "big"
))
IAT_phase_003_D <- IAT_phase_003_analysis%>%
filter(screen_id %in% c(3, 4, 6, 7)) %>%
filter(rt<=10000)%>%
group_by(ID,task_id, version) %>%  ##subj_idx,
summarize(
mean_rt = mean(rt),
sd_rt = sd(rt),
row_n = n()) %>%
ungroup()%>%
pivot_wider(names_from = version, values_from = c(mean_rt, sd_rt,row_n)) %>%
mutate(
diff_B1A1 = mean_rt_B1 - mean_rt_A1,
diff_B2A2 = mean_rt_B2 - mean_rt_A2) %>%
group_by(subj_idx,task_id) %>%##subj_idx,
summarize(
SD_B1A1 = sqrt((((row_n_A1-1)*(sd_rt_A1^2)+(row_n_B1-1)*(sd_rt_B1^2))+((row_n_A1+row_n_B1)*((mean_rt_A1-mean_rt_B1)^2)/4))/(row_n_A1+row_n_B1-1)),
SD_B2A2 = sqrt((((row_n_A2-1)*(sd_rt_A2^2)+(row_n_B2-1)*(sd_rt_B2^2))+((row_n_A2+row_n_B2)*((mean_rt_A2-mean_rt_B2)^2)/4))/(row_n_A2+row_n_B2-1)),
D=( (diff_B1A1/SD_B1A1)+ (diff_B2A2/SD_B2A2))/2
)%>%
mutate(
effect = case_when(
abs(D) <= 0.2 ~ "small",
abs(D) <= 0.5 ~ "mid",
TRUE ~ "big"
))
IAT_phase_003_D <- IAT_phase_003_analysis%>%
filter(screen_id %in% c(3, 4, 6, 7)) %>%
filter(rt<=10000)%>%
group_by(ID,task_id, version) %>%  ##subj_idx,
summarize(
mean_rt = mean(rt),
sd_rt = sd(rt),
row_n = n()) %>%
ungroup()%>%
pivot_wider(names_from = version, values_from = c(mean_rt, sd_rt,row_n)) %>%
mutate(
diff_B1A1 = mean_rt_B1 - mean_rt_A1,
diff_B2A2 = mean_rt_B2 - mean_rt_A2) %>%
group_by(ID,task_id) %>%##subj_idx,
summarize(
SD_B1A1 = sqrt((((row_n_A1-1)*(sd_rt_A1^2)+(row_n_B1-1)*(sd_rt_B1^2))+((row_n_A1+row_n_B1)*((mean_rt_A1-mean_rt_B1)^2)/4))/(row_n_A1+row_n_B1-1)),
SD_B2A2 = sqrt((((row_n_A2-1)*(sd_rt_A2^2)+(row_n_B2-1)*(sd_rt_B2^2))+((row_n_A2+row_n_B2)*((mean_rt_A2-mean_rt_B2)^2)/4))/(row_n_A2+row_n_B2-1)),
D=( (diff_B1A1/SD_B1A1)+ (diff_B2A2/SD_B2A2))/2
)%>%
mutate(
effect = case_when(
abs(D) <= 0.2 ~ "small",
abs(D) <= 0.5 ~ "mid",
TRUE ~ "big"
))
View(IAT_phase_003_D)
IAT_phase_003_RT <- IAT_phase_003_analysis%>%
filter(screen_id %in% c(3, 4, 6, 7)) %>%
filter(rt<=10000)%>%
group_by(ID,task_id, version) %>%  ##subj_idx,
summarize(
mean_rt = mean(rt),
sd_rt = sd(rt),
row_n = n())
View(IAT_phase_003_RT)
IAT_phase_003_RT <- IAT_phase_003_analysis%>%
filter(screen_id %in% c(3, 4, 6, 7)) %>%
filter(rt<=10000)%>%
group_by(ID,task_id) %>%  ##subj_idx,
summarize(
mean_rt = mean(rt),
sd_rt = sd(rt),
row_n = n())
View(IAT_phase_003)
IAT_phase_003_RT <- IAT_phase_003_analysis%>%
filter(screen_id %in% c(3, 4, 6, 7)) %>%
filter(rt<=10000)%>%
group_by(ID,task_id,condition) %>%  ##subj_idx,
summarize(
mean_rt = mean(rt),
sd_rt = sd(rt),
row_n = n())
IAT_phase_003_RT <- IAT_phase_003_analysis%>%
filter(screen_id %in% c(3, 4, 6, 7)) %>%
filter(rt<=10000)%>%
group_by(ID,task_id,condition,version) %>%  ##subj_idx,
summarize(
mean_rt = mean(rt),
sd_rt = sd(rt),
row_n = n())
getwd() #查看工作目录，
raw_day1<-read.csv("../../../Data/raw/day1/phase_002/day1_phase_002.csv")#修改phase_002
raw_day1_check <- function(data) {
trial_idx_prac_ALT1_1 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_1") %>%
summarize(trial_idx_prac_ALT1_1 = min(trial_index))
trial_idx_prac_ALT1_2 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_2") %>%
summarize(trial_idx_prac_ALT1_2= min(trial_index))
trial_idx_IAT_moral <- data %>%
group_by(ID) %>%
filter(task_id == "moral") %>%
summarize(trial_idx_IAT_moral = min(trial_index))
trial_idx_IAT_ability <- data %>%
group_by(ID) %>%
filter(task_id == "ability") %>%
summarize(trial_idx_IAT_ability = min(trial_index))
merged_data <- merge(trial_idx_prac_ALT1_1,trial_idx_prac_ALT1_2, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_moral, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_ability, by = "ID", all = TRUE)
merged_data <- merged_data %>%
left_join(data %>% filter(identity == "match") %>% select(ID, correct_response), by = "ID")%>%
distinct()
merged_data <- merged_data %>%
left_join(data %>% filter(version_attrib %in% c(1, 2) |
version_attrib2 %in% c(1, 2) ) %>% select(ID, version_attrib,version_target,version_attrib2,version_target2), by = "ID")%>%
rename(attrib_ability=version_attrib,
attrib_moral=version_attrib2,
target_ability=version_target,
target_moral = version_target2)%>%
print(merged_data)
}
raw_day1_check(raw_day1)
raw_day1<-read.csv("../../../Data/raw/day1/phase_002/day1_phase_002.csv")#修改phase_002
raw_day1_check <- function(data) {
trial_idx_prac_ALT1_1 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_1") %>%
summarize(trial_idx_prac_ALT1_1 = min(trial_index))
trial_idx_prac_ALT1_2 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_2") %>%
summarize(trial_idx_prac_ALT1_2= min(trial_index))
trial_idx_IAT_moral <- data %>%
group_by(ID) %>%
filter(task_id == "moral") %>%
summarize(trial_idx_IAT_moral = min(trial_index))
trial_idx_IAT_ability <- data %>%
group_by(ID) %>%
filter(task_id == "ability") %>%
summarize(trial_idx_IAT_ability = min(trial_index))
merged_data <- merge(trial_idx_prac_ALT1_1,trial_idx_prac_ALT1_2, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_moral, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_ability, by = "ID", all = TRUE)
merged_data <- merged_data %>%
left_join(data %>% filter(identity == "match") %>% select(ID, correct_response), by = "ID")%>%
distinct()
merged_data <- merged_data %>%
left_join(data %>% filter(version_attrib %in% c(1, 2) |
version_attrib2 %in% c(1, 2) ) %>% select(ID, version_attrib,version_target,version_attrib2,version_target2), by = "ID")
%>%
raw_day1<-read.csv("../../../Data/raw/day1/phase_002/day1_phase_002.csv")#修改phase_002
raw_day1_check <- function(data) {
trial_idx_prac_ALT1_1 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_1") %>%
summarize(trial_idx_prac_ALT1_1 = min(trial_index))
trial_idx_prac_ALT1_2 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_2") %>%
summarize(trial_idx_prac_ALT1_2= min(trial_index))
trial_idx_IAT_moral <- data %>%
group_by(ID) %>%
filter(task_id == "moral") %>%
summarize(trial_idx_IAT_moral = min(trial_index))
trial_idx_IAT_ability <- data %>%
group_by(ID) %>%
filter(task_id == "ability") %>%
summarize(trial_idx_IAT_ability = min(trial_index))
merged_data <- merge(trial_idx_prac_ALT1_1,trial_idx_prac_ALT1_2, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_moral, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_ability, by = "ID", all = TRUE)
merged_data <- merged_data %>%
left_join(data %>% filter(identity == "match") %>% select(ID, correct_response), by = "ID")%>%
distinct()
merged_data <- merged_data %>%
left_join(data %>% filter(version_attrib %in% c(1, 2) |
version_attrib2 %in% c(1, 2) ) %>% select(ID, version_attrib,version_target,version_attrib2,version_target2), by = "ID")%>%
mutate(IAT_first = ifelse(trial_idx_IAT_moral < trial_idx_IAT_ability, "IAT_moral", "IAT_ability"))%>%
mutate(ALT_first = ifelse(trial_idx_prac_ALT1_1 < trial_idx_prac_ALT1_2, "ALT1_1", "ALT1_2"))%>%
rename(attrib_ability=version_attrib,
attrib_moral=version_attrib2,
target_ability=version_target,
target_moral = version_target2)%>%
print(merged_data)
}
raw_day1_check(raw_day1)
raw_day2<-read.csv("../../../Data/raw/day2/phase_003/day2_phase_003.csv")#修改phase_002
get_first_trial_indices <- function(data) {
trial_idx_EW_practice <- data %>%
group_by(ID) %>%
filter(screen_id == "EW_practice") %>%
summarize(first_trial_idx_EW_practice = min(trial_index))
trial_idx_prac_ALT2_moral <- data %>%
group_by(ID) %>%
filter(task_id == "prac_ALT2_moral") %>%
summarize(first_trial_idx_prac_ALT2_moral = min(trial_index))
trial_idx_prac_ALT2_ability <- data %>%
group_by(ID) %>%
filter(task_id == "prac_ALT2_ability") %>%
summarize(first_trial_idx_prac_ALT2_ability = min(trial_index))
merged_data <- merge(trial_idx_EW_practice, trial_idx_prac_ALT2_moral, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_prac_ALT2_ability, by = "ID", all = TRUE)
merged_data <- merged_data %>%
left_join(data %>% filter(identity == "match") %>% select(ID, correct_response), by = "ID")%>%
mutate(ALT2_first = ifelse(first_trial_idx_prac_ALT2_moral < first_trial_idx_prac_ALT2_ability, "moral", "ability"))%>%
mutate(order_first = ifelse(first_trial_idx_EW_practice < first_trial_idx_prac_ALT2_moral & first_trial_idx_EW_practice < first_trial_idx_prac_ALT2_ability, "SRET", "ALT2"))
%>%
raw_day2<-read.csv("../../../Data/raw/day2/phase_003/day2_phase_003.csv")#修改phase_002
get_first_trial_indices <- function(data) {
trial_idx_EW_practice <- data %>%
group_by(ID) %>%
filter(screen_id == "EW_practice") %>%
summarize(first_trial_idx_EW_practice = min(trial_index))
trial_idx_prac_ALT2_moral <- data %>%
group_by(ID) %>%
filter(task_id == "prac_ALT2_moral") %>%
summarize(first_trial_idx_prac_ALT2_moral = min(trial_index))
trial_idx_prac_ALT2_ability <- data %>%
group_by(ID) %>%
filter(task_id == "prac_ALT2_ability") %>%
summarize(first_trial_idx_prac_ALT2_ability = min(trial_index))
merged_data <- merge(trial_idx_EW_practice, trial_idx_prac_ALT2_moral, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_prac_ALT2_ability, by = "ID", all = TRUE)
merged_data <- merged_data %>%
left_join(data %>% filter(identity == "match") %>% select(ID, correct_response), by = "ID")%>%
mutate(ALT2_first = ifelse(first_trial_idx_prac_ALT2_moral < first_trial_idx_prac_ALT2_ability, "moral", "ability"))%>%
mutate(order_first = ifelse(first_trial_idx_EW_practice < first_trial_idx_prac_ALT2_moral & first_trial_idx_EW_practice < first_trial_idx_prac_ALT2_ability, "SRET", "ALT2"))%>%
distinct()
print(merged_data)
}
get_first_trial_indices(raw_day2)
raw_day1<-read.csv("../../../Data/raw/day1/phase_002/day1_phase_002.csv")#修改phase_002
raw_day1_check <- function(data) {
trial_idx_prac_ALT1_1 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_1") %>%
summarize(trial_idx_prac_ALT1_1 = min(trial_index))
trial_idx_prac_ALT1_2 <- data %>%
group_by(ID) %>%
filter(screen_id == "prac_ALT1_2") %>%
summarize(trial_idx_prac_ALT1_2= min(trial_index))
trial_idx_IAT_moral <- data %>%
group_by(ID) %>%
filter(task_id == "moral") %>%
summarize(trial_idx_IAT_moral = min(trial_index))
trial_idx_IAT_ability <- data %>%
group_by(ID) %>%
filter(task_id == "ability") %>%
summarize(trial_idx_IAT_ability = min(trial_index))
merged_data <- merge(trial_idx_prac_ALT1_1,trial_idx_prac_ALT1_2, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_moral, by = "ID", all = TRUE)
merged_data <- merge(merged_data, trial_idx_IAT_ability, by = "ID", all = TRUE)
merged_data <- merged_data %>%
left_join(data %>% filter(identity == "match") %>% select(ID, correct_response), by = "ID")%>%
distinct()
merged_data <- merged_data %>%
left_join(data %>% filter(version_attrib %in% c(1, 2) |
version_attrib2 %in% c(1, 2) ) %>% select(ID, version_attrib,version_target,version_attrib2,version_target2), by = "ID")%>%
mutate(IAT_first = ifelse(trial_idx_IAT_moral < trial_idx_IAT_ability, "IAT_moral", "IAT_ability"))%>%
mutate(ALT_first = ifelse(trial_idx_prac_ALT1_1 < trial_idx_prac_ALT1_2, "ALT1_1", "ALT1_2"))%>%
mutate(order_first = ifelse((trial_idx_IAT_moral < trial_idx_prac_ALT1_1 & trial_idx_IAT_moral < trial_idx_prac_ALT1_2) | (trial_idx_IAT_ability < trial_idx_prac_ALT1_1 & trial_idx_IAT_ability < trial_idx_prac_ALT1_2), "IAT", "ALT"))%>%
rename(attrib_ability=version_attrib,
attrib_moral=version_attrib2,
target_ability=version_target,
target_moral = version_target2)%>%
print(merged_data)
}
raw_day1_check(raw_day1)
