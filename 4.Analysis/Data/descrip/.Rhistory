filter(screen_id %in% c("RJ_formal_2")) %>%
mutate(correct = as.numeric(coalesce(correct, 0))) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (correct=="0")) ~ "self_miss",
(identity == "friend" & (correct=="0" )) ~ "friend_miss",
(is.na(identity) & (correct=="0")) ~ "fa",
(is.na(identity) & (correct=="1")) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
Self_H = self_H/(self_H+self_M),
friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_H2 = ifelse(P_H == 1, 1 - 1 / (2 * (H + M)), P_H),# if hit rate is 1, standardize it
P_FA2 = ifelse(P_FA == 0, 1 / (2 * (H + M)), P_FA), # if FA rate is 0, standardize it
Correct_recognition = P_H - P_FA,
Z_P_H = qnorm(P_H2),
Z_P_FA = qnorm(P_FA2),
d_prime = Z_P_H - Z_P_FA)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
# mutate(correct = as.numeric(correct)) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
mutate(correct = as.numeric(coalesce(correct, 0))) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (correct=="0")) ~ "self_miss",
(identity == "friend" & (correct=="0" )) ~ "friend_miss",
(is.na(identity) & (correct=="0")) ~ "fa",
(is.na(identity) & (correct=="1")) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 - P_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
# mutate(correct = as.numeric(correct)) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
mutate(correct = as.numeric(coalesce(correct, 0))) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (correct=="0")) ~ "self_miss",
(identity == "friend" & (correct=="0" )) ~ "friend_miss",
(is.na(identity) & (correct=="0")) ~ "fa",
(is.na(identity) & (correct=="1")) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
# mutate(correct = as.numeric(correct)) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (is.na(correct))) ~ "self_miss",
(identity == "friend" & (is.na(correct) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
mutate(correct = as.numeric(correct)) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (is.na(correct))) ~ "self_miss",
(identity == "friend" & (is.na(correct) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
mutate(correct = as.numeric(coalesce(correct,null))) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (is.na(correct))) ~ "self_miss",
(identity == "friend" & (is.na(correct) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
mutate(correct = as.numeric(coalesce(correct,"null"))) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (is.na(correct))) ~ "self_miss",
(identity == "friend" & (is.na(correct) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
mutate(correct = as.numeric(coalesce(correct,-1))) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (!is.na(response))) ~ "self_miss",
(identity == "friend" & (!is.na(response) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
mutate(correct = as.numeric(coalesce(correct,-1))) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (!is.na(response))) ~ "self_miss",
(identity == "friend" & (!is.na(response) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
n=n(),
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/(self_H+self_M),
P_friend_H = friend_H/(friend_H+friend_M),
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (self_H + self_M)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (self_H + self_M)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (friend_H + friend_M)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (friend_H + friend_M)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
mutate(correct = as.numeric(coalesce(correct,-1))) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (!is.na(response))) ~ "self_miss",
(identity == "friend" & (!is.na(response) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
n=n(),
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/10,
P_friend_H = friend_H/10,
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (self_H + CR + self_M + FA),
friend_recognition = (friend_H + CR) / (friend_H + CR + friend_M + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (10)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (10)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (10)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (10)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
SRET_Source_M<-function(data){
SRET_RJ_2 <- data %>%
mutate(ID = as.character(ID)) %>%
mutate(rt = as.numeric(rt)) %>%
mutate(correct = as.numeric(coalesce(correct,-1))) %>%
filter(screen_id %in% c("RJ_formal_2")) %>%
filter(!word %in% c("严谨", "认真", "刻板", "白痴", "忠实", "宽宏", "徇私", "可鄙")) %>%
mutate(sdt = case_when((identity == "self" & (correct=="1")) ~ "self_hit",
(identity == "friend" & (correct=="1" )) ~ "friend_hit",
(identity == "self" & (!is.na(response))) ~ "self_miss",
(identity == "friend" & (!is.na(response) )) ~ "friend_miss",
(is.na(identity) & (!is.na(response))) ~ "fa",
(is.na(identity) & (is.na(response))) ~ "cr"))%>%
group_by(ID,valence,domain) %>%
summarize(
n=n(),
self_H = sum(sdt == "self_hit"),
friend_H = sum(sdt == "friend_hit"),
self_M = sum(sdt == "self_miss"),
friend_M = sum(sdt == "friend_miss"),
FA = sum(sdt == "fa"),
CR = sum(sdt == "cr"),
# P_H = ifelse(H + M == 0, 0, H / (H + M)),
P_Self_H = self_H/10,
P_friend_H = friend_H/10,
P_FA = FA/(FA+CR),
# P_FA = ifelse(FA + CR == 0, 0, FA / (FA + CR)),
self_recognition = (self_H + CR) / (10+ CR  + FA),
friend_recognition = (friend_H + CR) / (10+ CR  + FA),
avg_rt = mean(rt, na.rm = TRUE),
sd_rt = sd(rt, na.rm = TRUE),
) %>%
mutate(
P_self_H2 = ifelse(P_Self_H == 1, 1 - 1 / (2 * (10)), P_Self_H),# if hit rate is 1, standardize it
P_self_FA2 = ifelse(P_FA == 0, 1 / (2 * (10)), P_FA), # if FA rate is 0, standardize it
Self_Correct_recognition = P_self_H2 -P_self_FA2,
Z_P_self_H = qnorm(P_self_H2),
Z_P_FA = qnorm(P_self_FA2),
self_d_prime = Z_P_self_H - Z_P_FA,
P_friend_H2 = ifelse(P_friend_H == 1, 1 - 1 / (2 * (10)), P_friend_H),# if hit rate is 1, standardize it
P_friend_FA2 = ifelse(P_FA == 0, 1 / (2 * (10)), P_FA), # if FA rate is 0, standardize it
friend_Correct_recognition =P_friend_H2 - P_friend_FA2,
Z_P_friend_H = qnorm(P_friend_H2),
Z_P_friend_FA = qnorm( P_friend_FA2),
self_d_prime = Z_P_friend_H - Z_P_friend_FA,)
print(SRET_RJ_2)
}
SRET_Source_M(SRET_phase_003)
